---
title: a11y Integration (beta)
---

# A11y Integration (beta)

Lint your token schema for a11y errors. Can check your color + typography tokens for contrast.

Install the plugin:

```sh
npm i -D @cobalt-ui/lint-a11y
```

Then add to your `tokens.config.js` file:

```js
// tokens.config.js
import a11y from '@cobalt-ui/lint-a11y';

/** @type {import('@cobalt-ui/core').Config} */
export default {
  tokens: './tokens.json',
  outDir: './tokens/',
  plugins: [a11y()],
  lint: {
    // checks
  },
};
```

## a11y/contrast

The contrast check asserts your token combinations the latest WCAG 2.1 and [APCA](https://www.myndex.com/APCA/) (WCAG 3 proposal) formulae. Add an array of `checks` to test:

```js
import a11y from '@cobalt-ui/lint-a11y';

/** @type {import('@cobalt-ui/core').Config} */
export default {
  tokens: './tokens.json',
  outDir: './tokens/',
  plugins: [a11y()],
  lint: {
    rules: {
      'a11y/contrast': [
        'error',
        {
          checks: [
            {
              tokens: {
                foreground: 'color.semantic.text',
                background: 'color.semantic.bg',
                typography: 'typography.body',
                modes: ['light', 'dark'],
              },
              wcag2: 'AAA',
              apca: true,
            },
          ],
        },
      ],
    },
  },
};
```

### Check options

Within each check group, specify:

| Name                |              Type              | Description                                                                                                                             |
| :------------------ | :----------------------------: | :-------------------------------------------------------------------------------------------------------------------------------------- |
| `tokens`            |            `object`            | A group of tokens to test together.                                                                                                     |
| `tokens.foreground` |            `string`            | The ID of the foreground color.                                                                                                         |
| `tokens.background` |            `string`            | The ID of the background color.                                                                                                         |
| `tokens.typography` |            `string`            | (optional) The ID of a typography stack                                                                                                 |
| `tokens.modes`      |           `string[]`           | (optional) Any modes you’d like to test                                                                                                 |
| `wcag2`             |  `string \| number \| false`   | Specify `'AA'` or `'AAA'` compliance (or a minimum contrast), or `false` to disable (default: `'AA'`). See [WCAG 2](#wcag-2)            |
| `apca`              | `boolean \| 'body' \| number ` | Specify `true`/`false` to enable, or a Lc Contrast number, or `'body'` to enforce body text mode (default: `false`). See [APCA](#apca). |

#### WCAG 2

The [WCAG 2 contrast formula](https://www.w3.org/WAI/WCAG21/Understanding/contrast-minimum) is represented by the `wcag2` setting and accepts either a string, number, or `false`:

| Value                | Number Equivalent | Minimum Contrast |
| :------------------- | ----------------: | :--------------- |
| `'AA'` (default)     |             `4.5` | 4.5:1            |
| `'AA'` (large text)  |               `3` | 3:1              |
| `'AAA'`              |               `7` | 7:1              |
| `'AAA'` (large text) |             `4.5` | 4.5:1            |
| `false`              |               `0` | (any)            |

The WCAG 2 standard is the most common contrast standard, so `'AA'` level is enforced by default by this plugin.

If you pass a `typography` token, it will take font size and weight into account (meaning for larger fonts, you don’t need as much color contrast). If no `typography` token is passed, it will assume default font size (16px, normal).

#### APCA

::: warning

APCA is still a draft, and not part of WCAG 3. But APCA _is_ [well-researched](https://github.com/Myndex/SAPC-APCA?tab=readme-ov-file) and [widely-regarded](https://evilmartians.com/opensource/polychrom) as an improvement over WCAG 2. Compliance with APCA doesn’t guarantee compliance with WCAG 3 when it releases.

:::

The [APCA contrast algorithm](https://www.myndex.com/APCA/) is still in beta, but is a likely candidate for the upcoming WCAG 3 contrast algorithm. APCA uses the [latest research in color science](https://git.apcacontrast.com/documentation/WhyAPCA) and implements more perceptual contrast ratios that yield more accurate results. But it can be tricky to understand.

The recommended setting is first starting with `'bronze'` enforcement (somewhat-equivalent to `'AA'` in WCAG 2):

```js
{
  apca: 'bronze', // or 'bronze-body' for body text
}
```

Then, after running a check, you’ll either **pass** or **fail.** If you fail, the error message will show you by _how much_ you were off (e.g. `Expected 75, received`). You then have 3 courses of action:

1. **Increase contrast.** Simply adjust the color to a higher contrast, or adjust the font size / font weight.
2. **Accept the current level.** If you feel like Cobalt calculated your contrast wrong (explained below), you can change `apca` to the Lc number (e.g. `apca: 60`).
3. **Disable APCA for this check**. Perhaps this particular color combination, or typography stack, isn’t performing well under the APCA working draft. Simply set `apca: false` to skip this check.

| Setting         | Description                                                                      |
| :-------------- | :------------------------------------------------------------------------------- |
| `'bronze'`      | Enforce [Bronze](https://www.myndex.com/APCA/#Bronze)-level conformance.         |
| `'bronze-body'` | Enforce Bronze-level compliance for body text (must hit `15 Lc` higher contrast) |
| `number`        | ⚠️ Advanced users: specify Lc Contrast (which will differ based on typography).  |
| `false`         | Disable APCA.                                                                    |

::: info

APCA calculated its contrast tables off of Helvetica, which you probably aren’t using. So it allows some wiggle room with different typefaces (some typefaces just render _bolder_ than others, or have a higher x-height, and therefore naturally have higher contrast). While any designer knows this is true, it introduces even more complexity to what’s supposed to be a mathematical check.

Cobalt uses official APCA metrics, but if after [reading the guide](https://www.myndex.com/APCA/) you are confident you have enough contrast with your color + typography combo as-is, you can lock in the current Lc contrast by specifying it manually.

:::

### Others

Are there other checks that you’d like to see here? [Suggest one!](https://github.com/drwpow/cobalt-ui/issues)
